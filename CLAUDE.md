# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## What This Is

`juanr` is an R data package with 35+ curated datasets for teaching political science, economics, and data science. Data-only package (no functions). Published at `hail2thief/juanr` on GitHub.

## Build Commands

```r
devtools::load_all()      # Load package locally
devtools::document()      # Regenerate docs from Roxygen
devtools::check()         # R CMD CHECK
```

README is generated from `README.rmd` (not edited directly):
```r
rmarkdown::render("README.rmd", output_format = "github_document")
```

## Architecture

The package follows a three-stage pipeline for each dataset:

1. **Raw data** in `data-raw/` (gitignored) — CSVs, XLSX, ZIP files
2. **Processing script** in `temp/` — tidyverse pipeline that cleans and saves
3. **Compiled data** in `data/` — `.rda` files (xz-compressed)

All dataset documentation lives in a single file: `R/data.R` (~1,100 lines of Roxygen blocks).

`man/` and `NAMESPACE` are auto-generated by Roxygen2 — never edit these directly.

## Adding a Dataset

1. Place raw data in `data-raw/`
2. Create `temp/<dataset_name>.R` following this pattern:
   ```r
   library(tidyverse)
   library(here)

   dataset_name <- read_csv("data-raw/file.csv") |>
     janitor::clean_names() |>
     mutate(...) |>
     select(...)

   save(dataset_name, file = here("data", "dataset_name.rda"), compress = "xz")
   ```
3. Add a Roxygen block to `R/data.R`:
   ```r
   #' Dataset Title
   #'
   #' Description of the dataset.
   #'
   #' @format A tibble with N rows and M variables:
   #' \itemize{
   #'   \item \strong{var_name:} description
   #' }
   #' @docType data
   #' @keywords datasets
   #' @name dataset_name
   #' @usage data(dataset_name)
   #' @source \url{https://...}
   "dataset_name"
   ```
4. Run `devtools::document()`

## Key Files

- `R/data.R` — Central documentation hub for all datasets
- `DESCRIPTION` — Package metadata (version, dependencies)
- `.Rbuildignore` — Excludes `temp/`, `README.Rmd` from package build
- `temp/` — All data processing scripts live here
